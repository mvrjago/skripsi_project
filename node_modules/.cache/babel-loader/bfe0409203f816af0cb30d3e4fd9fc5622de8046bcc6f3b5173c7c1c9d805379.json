{"ast":null,"code":"/**\n * @module ol/webgl/PostProcessingPass\n */\nvar DEFAULT_VERTEX_SHADER = \"\\n  precision mediump float;\\n  \\n  attribute vec2 a_position;\\n  varying vec2 v_texCoord;\\n  varying vec2 v_screenCoord;\\n  \\n  uniform vec2 u_screenSize;\\n   \\n  void main() {\\n    v_texCoord = a_position * 0.5 + 0.5;\\n    v_screenCoord = v_texCoord * u_screenSize;\\n    gl_Position = vec4(a_position, 0.0, 1.0);\\n  }\\n\";\nvar DEFAULT_FRAGMENT_SHADER = \"\\n  precision mediump float;\\n   \\n  uniform sampler2D u_image;\\n   \\n  varying vec2 v_texCoord;\\n   \\n  void main() {\\n    gl_FragColor = texture2D(u_image, v_texCoord);\\n  }\\n\";\n/**\n * @typedef {Object} Options\n * @property {WebGLRenderingContext} webGlContext WebGL context; mandatory.\n * @property {number} [scaleRatio] Scale ratio; if < 1, the post process will render to a texture smaller than\n * the main canvas that will then be sampled up (useful for saving resource on blur steps).\n * @property {string} [vertexShader] Vertex shader source\n * @property {string} [fragmentShader] Fragment shader source\n * @property {Object.<string,import(\"./Helper\").UniformValue>} [uniforms] Uniform definitions for the post process step\n */\n/**\n * @typedef {Object} UniformInternalDescription\n * @property {import(\"./Helper\").UniformValue} value Value\n * @property {number} location Location\n * @property {WebGLTexture} [texture] Texture\n * @private\n */\n/**\n * @classdesc\n * This class is used to define Post Processing passes with custom shaders and uniforms.\n * This is used internally by {@link module:ol/webgl/Helper~WebGLHelper}.\n *\n * Please note that the final output on the DOM canvas is expected to have premultiplied alpha, which means that\n * a pixel which is 100% red with an opacity of 50% must have a color of (r=0.5, g=0, b=0, a=0.5).\n * Failing to provide pixel colors with premultiplied alpha will result in render anomalies.\n *\n * The default post-processing pass does *not* multiply color values with alpha value, it expects color values to be\n * premultiplied.\n *\n * Default shaders are shown hereafter:\n *\n * * Vertex shader:\n *\n *   ```\n *   precision mediump float;\n *\n *   attribute vec2 a_position;\n *   varying vec2 v_texCoord;\n *   varying vec2 v_screenCoord;\n *\n *   uniform vec2 u_screenSize;\n *\n *   void main() {\n *     v_texCoord = a_position * 0.5 + 0.5;\n *     v_screenCoord = v_texCoord * u_screenSize;\n *     gl_Position = vec4(a_position, 0.0, 1.0);\n *   }\n *   ```\n *\n * * Fragment shader:\n *\n *   ```\n *   precision mediump float;\n *\n *   uniform sampler2D u_image;\n *\n *   varying vec2 v_texCoord;\n *\n *   void main() {\n *     gl_FragColor = texture2D(u_image, v_texCoord);\n *   }\n *   ```\n *\n * @api\n */\nvar WebGLPostProcessingPass = /** @class */function () {\n  /**\n   * @param {Options} options Options.\n   */\n  function WebGLPostProcessingPass(options) {\n    this.gl_ = options.webGlContext;\n    var gl = this.gl_;\n    this.scaleRatio_ = options.scaleRatio || 1;\n    this.renderTargetTexture_ = gl.createTexture();\n    this.renderTargetTextureSize_ = null;\n    this.frameBuffer_ = gl.createFramebuffer();\n    // compile the program for the frame buffer\n    // TODO: make compilation errors show up\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(vertexShader, options.vertexShader || DEFAULT_VERTEX_SHADER);\n    gl.compileShader(vertexShader);\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, options.fragmentShader || DEFAULT_FRAGMENT_SHADER);\n    gl.compileShader(fragmentShader);\n    this.renderTargetProgram_ = gl.createProgram();\n    gl.attachShader(this.renderTargetProgram_, vertexShader);\n    gl.attachShader(this.renderTargetProgram_, fragmentShader);\n    gl.linkProgram(this.renderTargetProgram_);\n    // bind the vertices buffer for the frame buffer\n    this.renderTargetVerticesBuffer_ = gl.createBuffer();\n    var verticesArray = [-1, -1, 1, -1, -1, 1, 1, -1, 1, 1, -1, 1];\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.renderTargetVerticesBuffer_);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(verticesArray), gl.STATIC_DRAW);\n    this.renderTargetAttribLocation_ = gl.getAttribLocation(this.renderTargetProgram_, 'a_position');\n    this.renderTargetUniformLocation_ = gl.getUniformLocation(this.renderTargetProgram_, 'u_screenSize');\n    this.renderTargetTextureLocation_ = gl.getUniformLocation(this.renderTargetProgram_, 'u_image');\n    /**\n     * Holds info about custom uniforms used in the post processing pass\n     * @type {Array<UniformInternalDescription>}\n     * @private\n     */\n    this.uniforms_ = [];\n    options.uniforms && Object.keys(options.uniforms).forEach(function (name) {\n      this.uniforms_.push({\n        value: options.uniforms[name],\n        location: gl.getUniformLocation(this.renderTargetProgram_, name)\n      });\n    }.bind(this));\n  }\n  /**\n   * Get the WebGL rendering context\n   * @return {WebGLRenderingContext} The rendering context.\n   * @api\n   */\n  WebGLPostProcessingPass.prototype.getGL = function () {\n    return this.gl_;\n  };\n  /**\n   * Initialize the render target texture of the post process, make sure it is at the\n   * right size and bind it as a render target for the next draw calls.\n   * The last step to be initialized will be the one where the primitives are rendered.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @api\n   */\n  WebGLPostProcessingPass.prototype.init = function (frameState) {\n    var gl = this.getGL();\n    var textureSize = [gl.drawingBufferWidth * this.scaleRatio_, gl.drawingBufferHeight * this.scaleRatio_];\n    // rendering goes to my buffer\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.getFrameBuffer());\n    gl.viewport(0, 0, textureSize[0], textureSize[1]);\n    // if size has changed: adjust canvas & render target texture\n    if (!this.renderTargetTextureSize_ || this.renderTargetTextureSize_[0] !== textureSize[0] || this.renderTargetTextureSize_[1] !== textureSize[1]) {\n      this.renderTargetTextureSize_ = textureSize;\n      // create a new texture\n      var level = 0;\n      var internalFormat = gl.RGBA;\n      var border = 0;\n      var format = gl.RGBA;\n      var type = gl.UNSIGNED_BYTE;\n      var data = null;\n      gl.bindTexture(gl.TEXTURE_2D, this.renderTargetTexture_);\n      gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, textureSize[0], textureSize[1], border, format, type, data);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      // bind the texture to the framebuffer\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.renderTargetTexture_, 0);\n    }\n  };\n  /**\n   * Render to the next postprocessing pass (or to the canvas if final pass).\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @param {WebGLPostProcessingPass} [nextPass] Next pass, optional\n   * @api\n   */\n  WebGLPostProcessingPass.prototype.apply = function (frameState, nextPass) {\n    var gl = this.getGL();\n    var size = frameState.size;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, nextPass ? nextPass.getFrameBuffer() : null);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this.renderTargetTexture_);\n    // render the frame buffer to the canvas\n    gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.renderTargetVerticesBuffer_);\n    gl.useProgram(this.renderTargetProgram_);\n    gl.enableVertexAttribArray(this.renderTargetAttribLocation_);\n    gl.vertexAttribPointer(this.renderTargetAttribLocation_, 2, gl.FLOAT, false, 0, 0);\n    gl.uniform2f(this.renderTargetUniformLocation_, size[0], size[1]);\n    gl.uniform1i(this.renderTargetTextureLocation_, 0);\n    this.applyUniforms(frameState);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n  };\n  /**\n   * @returns {WebGLFramebuffer} Frame buffer\n   * @api\n   */\n  WebGLPostProcessingPass.prototype.getFrameBuffer = function () {\n    return this.frameBuffer_;\n  };\n  /**\n   * Sets the custom uniforms based on what was given in the constructor.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @private\n   */\n  WebGLPostProcessingPass.prototype.applyUniforms = function (frameState) {\n    var gl = this.getGL();\n    var value;\n    var textureSlot = 1;\n    this.uniforms_.forEach(function (uniform) {\n      value = typeof uniform.value === 'function' ? uniform.value(frameState) : uniform.value;\n      // apply value based on type\n      if (value instanceof HTMLCanvasElement || value instanceof ImageData) {\n        // create a texture & put data\n        if (!uniform.texture) {\n          uniform.texture = gl.createTexture();\n        }\n        gl.activeTexture(gl[\"TEXTURE\" + textureSlot]);\n        gl.bindTexture(gl.TEXTURE_2D, uniform.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        if (value instanceof ImageData) {\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, value.width, value.height, 0, gl.UNSIGNED_BYTE, new Uint8Array(value.data));\n        } else {\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, value);\n        }\n        // fill texture slots\n        gl.uniform1i(uniform.location, textureSlot++);\n      } else if (Array.isArray(value)) {\n        switch (value.length) {\n          case 2:\n            gl.uniform2f(uniform.location, value[0], value[1]);\n            return;\n          case 3:\n            gl.uniform3f(uniform.location, value[0], value[1], value[2]);\n            return;\n          case 4:\n            gl.uniform4f(uniform.location, value[0], value[1], value[2], value[3]);\n            return;\n          default:\n            return;\n        }\n      } else if (typeof value === 'number') {\n        gl.uniform1f(uniform.location, value);\n      }\n    });\n  };\n  return WebGLPostProcessingPass;\n}();\nexport default WebGLPostProcessingPass;","map":{"version":3,"names":["DEFAULT_VERTEX_SHADER","DEFAULT_FRAGMENT_SHADER","WebGLPostProcessingPass","options","gl_","webGlContext","gl","scaleRatio_","scaleRatio","renderTargetTexture_","createTexture","renderTargetTextureSize_","frameBuffer_","createFramebuffer","vertexShader","createShader","VERTEX_SHADER","shaderSource","compileShader","fragmentShader","FRAGMENT_SHADER","renderTargetProgram_","createProgram","attachShader","linkProgram","renderTargetVerticesBuffer_","createBuffer","verticesArray","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","renderTargetAttribLocation_","getAttribLocation","renderTargetUniformLocation_","getUniformLocation","renderTargetTextureLocation_","uniforms_","uniforms","Object","keys","forEach","name","push","value","location","bind","prototype","getGL","init","frameState","textureSize","drawingBufferWidth","drawingBufferHeight","bindFramebuffer","FRAMEBUFFER","getFrameBuffer","viewport","level","internalFormat","RGBA","border","format","type","UNSIGNED_BYTE","data","bindTexture","TEXTURE_2D","texImage2D","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","framebufferTexture2D","COLOR_ATTACHMENT0","apply","nextPass","size","activeTexture","TEXTURE0","clearColor","clear","COLOR_BUFFER_BIT","enable","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","useProgram","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform2f","uniform1i","applyUniforms","drawArrays","TRIANGLES","textureSlot","uniform","HTMLCanvasElement","ImageData","texture","width","height","Uint8Array","Array","isArray","length","uniform3f","uniform4f","uniform1f"],"sources":["/Users/mariovicky/Skripsi_OpenLayers/node_modules/ol/src/webgl/PostProcessingPass.js"],"sourcesContent":["/**\n * @module ol/webgl/PostProcessingPass\n */\n\nconst DEFAULT_VERTEX_SHADER = `\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n`;\n\nconst DEFAULT_FRAGMENT_SHADER = `\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n`;\n\n/**\n * @typedef {Object} Options\n * @property {WebGLRenderingContext} webGlContext WebGL context; mandatory.\n * @property {number} [scaleRatio] Scale ratio; if < 1, the post process will render to a texture smaller than\n * the main canvas that will then be sampled up (useful for saving resource on blur steps).\n * @property {string} [vertexShader] Vertex shader source\n * @property {string} [fragmentShader] Fragment shader source\n * @property {Object.<string,import(\"./Helper\").UniformValue>} [uniforms] Uniform definitions for the post process step\n */\n\n/**\n * @typedef {Object} UniformInternalDescription\n * @property {import(\"./Helper\").UniformValue} value Value\n * @property {number} location Location\n * @property {WebGLTexture} [texture] Texture\n * @private\n */\n\n/**\n * @classdesc\n * This class is used to define Post Processing passes with custom shaders and uniforms.\n * This is used internally by {@link module:ol/webgl/Helper~WebGLHelper}.\n *\n * Please note that the final output on the DOM canvas is expected to have premultiplied alpha, which means that\n * a pixel which is 100% red with an opacity of 50% must have a color of (r=0.5, g=0, b=0, a=0.5).\n * Failing to provide pixel colors with premultiplied alpha will result in render anomalies.\n *\n * The default post-processing pass does *not* multiply color values with alpha value, it expects color values to be\n * premultiplied.\n *\n * Default shaders are shown hereafter:\n *\n * * Vertex shader:\n *\n *   ```\n *   precision mediump float;\n *\n *   attribute vec2 a_position;\n *   varying vec2 v_texCoord;\n *   varying vec2 v_screenCoord;\n *\n *   uniform vec2 u_screenSize;\n *\n *   void main() {\n *     v_texCoord = a_position * 0.5 + 0.5;\n *     v_screenCoord = v_texCoord * u_screenSize;\n *     gl_Position = vec4(a_position, 0.0, 1.0);\n *   }\n *   ```\n *\n * * Fragment shader:\n *\n *   ```\n *   precision mediump float;\n *\n *   uniform sampler2D u_image;\n *\n *   varying vec2 v_texCoord;\n *\n *   void main() {\n *     gl_FragColor = texture2D(u_image, v_texCoord);\n *   }\n *   ```\n *\n * @api\n */\nclass WebGLPostProcessingPass {\n  /**\n   * @param {Options} options Options.\n   */\n  constructor(options) {\n    this.gl_ = options.webGlContext;\n    const gl = this.gl_;\n\n    this.scaleRatio_ = options.scaleRatio || 1;\n\n    this.renderTargetTexture_ = gl.createTexture();\n    this.renderTargetTextureSize_ = null;\n\n    this.frameBuffer_ = gl.createFramebuffer();\n\n    // compile the program for the frame buffer\n    // TODO: make compilation errors show up\n    const vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(\n      vertexShader,\n      options.vertexShader || DEFAULT_VERTEX_SHADER\n    );\n    gl.compileShader(vertexShader);\n    const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(\n      fragmentShader,\n      options.fragmentShader || DEFAULT_FRAGMENT_SHADER\n    );\n    gl.compileShader(fragmentShader);\n    this.renderTargetProgram_ = gl.createProgram();\n    gl.attachShader(this.renderTargetProgram_, vertexShader);\n    gl.attachShader(this.renderTargetProgram_, fragmentShader);\n    gl.linkProgram(this.renderTargetProgram_);\n\n    // bind the vertices buffer for the frame buffer\n    this.renderTargetVerticesBuffer_ = gl.createBuffer();\n    const verticesArray = [-1, -1, 1, -1, -1, 1, 1, -1, 1, 1, -1, 1];\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.renderTargetVerticesBuffer_);\n    gl.bufferData(\n      gl.ARRAY_BUFFER,\n      new Float32Array(verticesArray),\n      gl.STATIC_DRAW\n    );\n\n    this.renderTargetAttribLocation_ = gl.getAttribLocation(\n      this.renderTargetProgram_,\n      'a_position'\n    );\n    this.renderTargetUniformLocation_ = gl.getUniformLocation(\n      this.renderTargetProgram_,\n      'u_screenSize'\n    );\n    this.renderTargetTextureLocation_ = gl.getUniformLocation(\n      this.renderTargetProgram_,\n      'u_image'\n    );\n\n    /**\n     * Holds info about custom uniforms used in the post processing pass\n     * @type {Array<UniformInternalDescription>}\n     * @private\n     */\n    this.uniforms_ = [];\n    options.uniforms &&\n      Object.keys(options.uniforms).forEach(\n        function (name) {\n          this.uniforms_.push({\n            value: options.uniforms[name],\n            location: gl.getUniformLocation(this.renderTargetProgram_, name),\n          });\n        }.bind(this)\n      );\n  }\n\n  /**\n   * Get the WebGL rendering context\n   * @return {WebGLRenderingContext} The rendering context.\n   * @api\n   */\n  getGL() {\n    return this.gl_;\n  }\n\n  /**\n   * Initialize the render target texture of the post process, make sure it is at the\n   * right size and bind it as a render target for the next draw calls.\n   * The last step to be initialized will be the one where the primitives are rendered.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @api\n   */\n  init(frameState) {\n    const gl = this.getGL();\n    const textureSize = [\n      gl.drawingBufferWidth * this.scaleRatio_,\n      gl.drawingBufferHeight * this.scaleRatio_,\n    ];\n\n    // rendering goes to my buffer\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.getFrameBuffer());\n    gl.viewport(0, 0, textureSize[0], textureSize[1]);\n\n    // if size has changed: adjust canvas & render target texture\n    if (\n      !this.renderTargetTextureSize_ ||\n      this.renderTargetTextureSize_[0] !== textureSize[0] ||\n      this.renderTargetTextureSize_[1] !== textureSize[1]\n    ) {\n      this.renderTargetTextureSize_ = textureSize;\n\n      // create a new texture\n      const level = 0;\n      const internalFormat = gl.RGBA;\n      const border = 0;\n      const format = gl.RGBA;\n      const type = gl.UNSIGNED_BYTE;\n      const data = null;\n      gl.bindTexture(gl.TEXTURE_2D, this.renderTargetTexture_);\n      gl.texImage2D(\n        gl.TEXTURE_2D,\n        level,\n        internalFormat,\n        textureSize[0],\n        textureSize[1],\n        border,\n        format,\n        type,\n        data\n      );\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n      // bind the texture to the framebuffer\n      gl.framebufferTexture2D(\n        gl.FRAMEBUFFER,\n        gl.COLOR_ATTACHMENT0,\n        gl.TEXTURE_2D,\n        this.renderTargetTexture_,\n        0\n      );\n    }\n  }\n\n  /**\n   * Render to the next postprocessing pass (or to the canvas if final pass).\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @param {WebGLPostProcessingPass} [nextPass] Next pass, optional\n   * @api\n   */\n  apply(frameState, nextPass) {\n    const gl = this.getGL();\n    const size = frameState.size;\n\n    gl.bindFramebuffer(\n      gl.FRAMEBUFFER,\n      nextPass ? nextPass.getFrameBuffer() : null\n    );\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this.renderTargetTexture_);\n\n    // render the frame buffer to the canvas\n    gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.renderTargetVerticesBuffer_);\n\n    gl.useProgram(this.renderTargetProgram_);\n    gl.enableVertexAttribArray(this.renderTargetAttribLocation_);\n    gl.vertexAttribPointer(\n      this.renderTargetAttribLocation_,\n      2,\n      gl.FLOAT,\n      false,\n      0,\n      0\n    );\n    gl.uniform2f(this.renderTargetUniformLocation_, size[0], size[1]);\n    gl.uniform1i(this.renderTargetTextureLocation_, 0);\n\n    this.applyUniforms(frameState);\n\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n  }\n\n  /**\n   * @returns {WebGLFramebuffer} Frame buffer\n   * @api\n   */\n  getFrameBuffer() {\n    return this.frameBuffer_;\n  }\n\n  /**\n   * Sets the custom uniforms based on what was given in the constructor.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @private\n   */\n  applyUniforms(frameState) {\n    const gl = this.getGL();\n\n    let value;\n    let textureSlot = 1;\n    this.uniforms_.forEach(function (uniform) {\n      value =\n        typeof uniform.value === 'function'\n          ? uniform.value(frameState)\n          : uniform.value;\n\n      // apply value based on type\n      if (value instanceof HTMLCanvasElement || value instanceof ImageData) {\n        // create a texture & put data\n        if (!uniform.texture) {\n          uniform.texture = gl.createTexture();\n        }\n        gl.activeTexture(gl[`TEXTURE${textureSlot}`]);\n        gl.bindTexture(gl.TEXTURE_2D, uniform.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n        if (value instanceof ImageData) {\n          gl.texImage2D(\n            gl.TEXTURE_2D,\n            0,\n            gl.RGBA,\n            gl.RGBA,\n            value.width,\n            value.height,\n            0,\n            gl.UNSIGNED_BYTE,\n            new Uint8Array(value.data)\n          );\n        } else {\n          gl.texImage2D(\n            gl.TEXTURE_2D,\n            0,\n            gl.RGBA,\n            gl.RGBA,\n            gl.UNSIGNED_BYTE,\n            value\n          );\n        }\n\n        // fill texture slots\n        gl.uniform1i(uniform.location, textureSlot++);\n      } else if (Array.isArray(value)) {\n        switch (value.length) {\n          case 2:\n            gl.uniform2f(uniform.location, value[0], value[1]);\n            return;\n          case 3:\n            gl.uniform3f(uniform.location, value[0], value[1], value[2]);\n            return;\n          case 4:\n            gl.uniform4f(\n              uniform.location,\n              value[0],\n              value[1],\n              value[2],\n              value[3]\n            );\n            return;\n          default:\n            return;\n        }\n      } else if (typeof value === 'number') {\n        gl.uniform1f(uniform.location, value);\n      }\n    });\n  }\n}\n\nexport default WebGLPostProcessingPass;\n"],"mappings":"AAAA;;;AAIA,IAAMA,qBAAqB,GAAG,mUAc7B;AAED,IAAMC,uBAAuB,GAAG,mLAU/B;AAED;;;;;;;;;AAUA;;;;;;;AAQA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA,IAAAC,uBAAA;EACE;;;EAGA,SAAAA,wBAAYC,OAAO;IACjB,IAAI,CAACC,GAAG,GAAGD,OAAO,CAACE,YAAY;IAC/B,IAAMC,EAAE,GAAG,IAAI,CAACF,GAAG;IAEnB,IAAI,CAACG,WAAW,GAAGJ,OAAO,CAACK,UAAU,IAAI,CAAC;IAE1C,IAAI,CAACC,oBAAoB,GAAGH,EAAE,CAACI,aAAa,EAAE;IAC9C,IAAI,CAACC,wBAAwB,GAAG,IAAI;IAEpC,IAAI,CAACC,YAAY,GAAGN,EAAE,CAACO,iBAAiB,EAAE;IAE1C;IACA;IACA,IAAMC,YAAY,GAAGR,EAAE,CAACS,YAAY,CAACT,EAAE,CAACU,aAAa,CAAC;IACtDV,EAAE,CAACW,YAAY,CACbH,YAAY,EACZX,OAAO,CAACW,YAAY,IAAId,qBAAqB,CAC9C;IACDM,EAAE,CAACY,aAAa,CAACJ,YAAY,CAAC;IAC9B,IAAMK,cAAc,GAAGb,EAAE,CAACS,YAAY,CAACT,EAAE,CAACc,eAAe,CAAC;IAC1Dd,EAAE,CAACW,YAAY,CACbE,cAAc,EACdhB,OAAO,CAACgB,cAAc,IAAIlB,uBAAuB,CAClD;IACDK,EAAE,CAACY,aAAa,CAACC,cAAc,CAAC;IAChC,IAAI,CAACE,oBAAoB,GAAGf,EAAE,CAACgB,aAAa,EAAE;IAC9ChB,EAAE,CAACiB,YAAY,CAAC,IAAI,CAACF,oBAAoB,EAAEP,YAAY,CAAC;IACxDR,EAAE,CAACiB,YAAY,CAAC,IAAI,CAACF,oBAAoB,EAAEF,cAAc,CAAC;IAC1Db,EAAE,CAACkB,WAAW,CAAC,IAAI,CAACH,oBAAoB,CAAC;IAEzC;IACA,IAAI,CAACI,2BAA2B,GAAGnB,EAAE,CAACoB,YAAY,EAAE;IACpD,IAAMC,aAAa,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IAChErB,EAAE,CAACsB,UAAU,CAACtB,EAAE,CAACuB,YAAY,EAAE,IAAI,CAACJ,2BAA2B,CAAC;IAChEnB,EAAE,CAACwB,UAAU,CACXxB,EAAE,CAACuB,YAAY,EACf,IAAIE,YAAY,CAACJ,aAAa,CAAC,EAC/BrB,EAAE,CAAC0B,WAAW,CACf;IAED,IAAI,CAACC,2BAA2B,GAAG3B,EAAE,CAAC4B,iBAAiB,CACrD,IAAI,CAACb,oBAAoB,EACzB,YAAY,CACb;IACD,IAAI,CAACc,4BAA4B,GAAG7B,EAAE,CAAC8B,kBAAkB,CACvD,IAAI,CAACf,oBAAoB,EACzB,cAAc,CACf;IACD,IAAI,CAACgB,4BAA4B,GAAG/B,EAAE,CAAC8B,kBAAkB,CACvD,IAAI,CAACf,oBAAoB,EACzB,SAAS,CACV;IAED;;;;;IAKA,IAAI,CAACiB,SAAS,GAAG,EAAE;IACnBnC,OAAO,CAACoC,QAAQ,IACdC,MAAM,CAACC,IAAI,CAACtC,OAAO,CAACoC,QAAQ,CAAC,CAACG,OAAO,CACnC,UAAUC,IAAI;MACZ,IAAI,CAACL,SAAS,CAACM,IAAI,CAAC;QAClBC,KAAK,EAAE1C,OAAO,CAACoC,QAAQ,CAACI,IAAI,CAAC;QAC7BG,QAAQ,EAAExC,EAAE,CAAC8B,kBAAkB,CAAC,IAAI,CAACf,oBAAoB,EAAEsB,IAAI;OAChE,CAAC;IACJ,CAAC,CAACI,IAAI,CAAC,IAAI,CAAC,CACb;EACL;EAEA;;;;;EAKA7C,uBAAA,CAAA8C,SAAA,CAAAC,KAAK,GAAL;IACE,OAAO,IAAI,CAAC7C,GAAG;EACjB,CAAC;EAED;;;;;;;EAOAF,uBAAA,CAAA8C,SAAA,CAAAE,IAAI,GAAJ,UAAKC,UAAU;IACb,IAAM7C,EAAE,GAAG,IAAI,CAAC2C,KAAK,EAAE;IACvB,IAAMG,WAAW,GAAG,CAClB9C,EAAE,CAAC+C,kBAAkB,GAAG,IAAI,CAAC9C,WAAW,EACxCD,EAAE,CAACgD,mBAAmB,GAAG,IAAI,CAAC/C,WAAW,CAC1C;IAED;IACAD,EAAE,CAACiD,eAAe,CAACjD,EAAE,CAACkD,WAAW,EAAE,IAAI,CAACC,cAAc,EAAE,CAAC;IACzDnD,EAAE,CAACoD,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAEN,WAAW,CAAC,CAAC,CAAC,EAAEA,WAAW,CAAC,CAAC,CAAC,CAAC;IAEjD;IACA,IACE,CAAC,IAAI,CAACzC,wBAAwB,IAC9B,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,KAAKyC,WAAW,CAAC,CAAC,CAAC,IACnD,IAAI,CAACzC,wBAAwB,CAAC,CAAC,CAAC,KAAKyC,WAAW,CAAC,CAAC,CAAC,EACnD;MACA,IAAI,CAACzC,wBAAwB,GAAGyC,WAAW;MAE3C;MACA,IAAMO,KAAK,GAAG,CAAC;MACf,IAAMC,cAAc,GAAGtD,EAAE,CAACuD,IAAI;MAC9B,IAAMC,MAAM,GAAG,CAAC;MAChB,IAAMC,MAAM,GAAGzD,EAAE,CAACuD,IAAI;MACtB,IAAMG,IAAI,GAAG1D,EAAE,CAAC2D,aAAa;MAC7B,IAAMC,IAAI,GAAG,IAAI;MACjB5D,EAAE,CAAC6D,WAAW,CAAC7D,EAAE,CAAC8D,UAAU,EAAE,IAAI,CAAC3D,oBAAoB,CAAC;MACxDH,EAAE,CAAC+D,UAAU,CACX/D,EAAE,CAAC8D,UAAU,EACbT,KAAK,EACLC,cAAc,EACdR,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdU,MAAM,EACNC,MAAM,EACNC,IAAI,EACJE,IAAI,CACL;MAED5D,EAAE,CAACgE,aAAa,CAAChE,EAAE,CAAC8D,UAAU,EAAE9D,EAAE,CAACiE,kBAAkB,EAAEjE,EAAE,CAACkE,MAAM,CAAC;MACjElE,EAAE,CAACgE,aAAa,CAAChE,EAAE,CAAC8D,UAAU,EAAE9D,EAAE,CAACmE,cAAc,EAAEnE,EAAE,CAACoE,aAAa,CAAC;MACpEpE,EAAE,CAACgE,aAAa,CAAChE,EAAE,CAAC8D,UAAU,EAAE9D,EAAE,CAACqE,cAAc,EAAErE,EAAE,CAACoE,aAAa,CAAC;MAEpE;MACApE,EAAE,CAACsE,oBAAoB,CACrBtE,EAAE,CAACkD,WAAW,EACdlD,EAAE,CAACuE,iBAAiB,EACpBvE,EAAE,CAAC8D,UAAU,EACb,IAAI,CAAC3D,oBAAoB,EACzB,CAAC,CACF;;EAEL,CAAC;EAED;;;;;;EAMAP,uBAAA,CAAA8C,SAAA,CAAA8B,KAAK,GAAL,UAAM3B,UAAU,EAAE4B,QAAQ;IACxB,IAAMzE,EAAE,GAAG,IAAI,CAAC2C,KAAK,EAAE;IACvB,IAAM+B,IAAI,GAAG7B,UAAU,CAAC6B,IAAI;IAE5B1E,EAAE,CAACiD,eAAe,CAChBjD,EAAE,CAACkD,WAAW,EACduB,QAAQ,GAAGA,QAAQ,CAACtB,cAAc,EAAE,GAAG,IAAI,CAC5C;IACDnD,EAAE,CAAC2E,aAAa,CAAC3E,EAAE,CAAC4E,QAAQ,CAAC;IAC7B5E,EAAE,CAAC6D,WAAW,CAAC7D,EAAE,CAAC8D,UAAU,EAAE,IAAI,CAAC3D,oBAAoB,CAAC;IAExD;IACAH,EAAE,CAAC6E,UAAU,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;IACjC7E,EAAE,CAAC8E,KAAK,CAAC9E,EAAE,CAAC+E,gBAAgB,CAAC;IAC7B/E,EAAE,CAACgF,MAAM,CAAChF,EAAE,CAACiF,KAAK,CAAC;IACnBjF,EAAE,CAACkF,SAAS,CAAClF,EAAE,CAACmF,GAAG,EAAEnF,EAAE,CAACoF,mBAAmB,CAAC;IAC5CpF,EAAE,CAACoD,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAEpD,EAAE,CAAC+C,kBAAkB,EAAE/C,EAAE,CAACgD,mBAAmB,CAAC;IAEhEhD,EAAE,CAACsB,UAAU,CAACtB,EAAE,CAACuB,YAAY,EAAE,IAAI,CAACJ,2BAA2B,CAAC;IAEhEnB,EAAE,CAACqF,UAAU,CAAC,IAAI,CAACtE,oBAAoB,CAAC;IACxCf,EAAE,CAACsF,uBAAuB,CAAC,IAAI,CAAC3D,2BAA2B,CAAC;IAC5D3B,EAAE,CAACuF,mBAAmB,CACpB,IAAI,CAAC5D,2BAA2B,EAChC,CAAC,EACD3B,EAAE,CAACwF,KAAK,EACR,KAAK,EACL,CAAC,EACD,CAAC,CACF;IACDxF,EAAE,CAACyF,SAAS,CAAC,IAAI,CAAC5D,4BAA4B,EAAE6C,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;IACjE1E,EAAE,CAAC0F,SAAS,CAAC,IAAI,CAAC3D,4BAA4B,EAAE,CAAC,CAAC;IAElD,IAAI,CAAC4D,aAAa,CAAC9C,UAAU,CAAC;IAE9B7C,EAAE,CAAC4F,UAAU,CAAC5F,EAAE,CAAC6F,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC;EACnC,CAAC;EAED;;;;EAIAjG,uBAAA,CAAA8C,SAAA,CAAAS,cAAc,GAAd;IACE,OAAO,IAAI,CAAC7C,YAAY;EAC1B,CAAC;EAED;;;;;EAKAV,uBAAA,CAAA8C,SAAA,CAAAiD,aAAa,GAAb,UAAc9C,UAAU;IACtB,IAAM7C,EAAE,GAAG,IAAI,CAAC2C,KAAK,EAAE;IAEvB,IAAIJ,KAAK;IACT,IAAIuD,WAAW,GAAG,CAAC;IACnB,IAAI,CAAC9D,SAAS,CAACI,OAAO,CAAC,UAAU2D,OAAO;MACtCxD,KAAK,GACH,OAAOwD,OAAO,CAACxD,KAAK,KAAK,UAAU,GAC/BwD,OAAO,CAACxD,KAAK,CAACM,UAAU,CAAC,GACzBkD,OAAO,CAACxD,KAAK;MAEnB;MACA,IAAIA,KAAK,YAAYyD,iBAAiB,IAAIzD,KAAK,YAAY0D,SAAS,EAAE;QACpE;QACA,IAAI,CAACF,OAAO,CAACG,OAAO,EAAE;UACpBH,OAAO,CAACG,OAAO,GAAGlG,EAAE,CAACI,aAAa,EAAE;;QAEtCJ,EAAE,CAAC2E,aAAa,CAAC3E,EAAE,CAAC,YAAU8F,WAAa,CAAC,CAAC;QAC7C9F,EAAE,CAAC6D,WAAW,CAAC7D,EAAE,CAAC8D,UAAU,EAAEiC,OAAO,CAACG,OAAO,CAAC;QAC9ClG,EAAE,CAACgE,aAAa,CAAChE,EAAE,CAAC8D,UAAU,EAAE9D,EAAE,CAACiE,kBAAkB,EAAEjE,EAAE,CAACkE,MAAM,CAAC;QACjElE,EAAE,CAACgE,aAAa,CAAChE,EAAE,CAAC8D,UAAU,EAAE9D,EAAE,CAACmE,cAAc,EAAEnE,EAAE,CAACoE,aAAa,CAAC;QACpEpE,EAAE,CAACgE,aAAa,CAAChE,EAAE,CAAC8D,UAAU,EAAE9D,EAAE,CAACqE,cAAc,EAAErE,EAAE,CAACoE,aAAa,CAAC;QAEpE,IAAI7B,KAAK,YAAY0D,SAAS,EAAE;UAC9BjG,EAAE,CAAC+D,UAAU,CACX/D,EAAE,CAAC8D,UAAU,EACb,CAAC,EACD9D,EAAE,CAACuD,IAAI,EACPvD,EAAE,CAACuD,IAAI,EACPhB,KAAK,CAAC4D,KAAK,EACX5D,KAAK,CAAC6D,MAAM,EACZ,CAAC,EACDpG,EAAE,CAAC2D,aAAa,EAChB,IAAI0C,UAAU,CAAC9D,KAAK,CAACqB,IAAI,CAAC,CAC3B;SACF,MAAM;UACL5D,EAAE,CAAC+D,UAAU,CACX/D,EAAE,CAAC8D,UAAU,EACb,CAAC,EACD9D,EAAE,CAACuD,IAAI,EACPvD,EAAE,CAACuD,IAAI,EACPvD,EAAE,CAAC2D,aAAa,EAChBpB,KAAK,CACN;;QAGH;QACAvC,EAAE,CAAC0F,SAAS,CAACK,OAAO,CAACvD,QAAQ,EAAEsD,WAAW,EAAE,CAAC;OAC9C,MAAM,IAAIQ,KAAK,CAACC,OAAO,CAAChE,KAAK,CAAC,EAAE;QAC/B,QAAQA,KAAK,CAACiE,MAAM;UAClB,KAAK,CAAC;YACJxG,EAAE,CAACyF,SAAS,CAACM,OAAO,CAACvD,QAAQ,EAAED,KAAK,CAAC,CAAC,CAAC,EAAEA,KAAK,CAAC,CAAC,CAAC,CAAC;YAClD;UACF,KAAK,CAAC;YACJvC,EAAE,CAACyG,SAAS,CAACV,OAAO,CAACvD,QAAQ,EAAED,KAAK,CAAC,CAAC,CAAC,EAAEA,KAAK,CAAC,CAAC,CAAC,EAAEA,KAAK,CAAC,CAAC,CAAC,CAAC;YAC5D;UACF,KAAK,CAAC;YACJvC,EAAE,CAAC0G,SAAS,CACVX,OAAO,CAACvD,QAAQ,EAChBD,KAAK,CAAC,CAAC,CAAC,EACRA,KAAK,CAAC,CAAC,CAAC,EACRA,KAAK,CAAC,CAAC,CAAC,EACRA,KAAK,CAAC,CAAC,CAAC,CACT;YACD;UACF;YACE;;OAEL,MAAM,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;QACpCvC,EAAE,CAAC2G,SAAS,CAACZ,OAAO,CAACvD,QAAQ,EAAED,KAAK,CAAC;;IAEzC,CAAC,CAAC;EACJ,CAAC;EACH,OAAA3C,uBAAC;AAAD,CAAC,CAlRD;AAoRA,eAAeA,uBAAuB"},"metadata":{},"sourceType":"module","externalDependencies":[]}
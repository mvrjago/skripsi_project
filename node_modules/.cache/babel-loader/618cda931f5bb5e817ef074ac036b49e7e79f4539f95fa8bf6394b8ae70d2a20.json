{"ast":null,"code":"var _jsxFileName = \"/Users/mariovicky/Skripsi_OpenLayers/src/containers/Map/Map.js\";\nimport React, { Component } from 'react';\nimport 'ol/ol.css';\nimport './Map.css';\nimport Map from 'ol/Map.js';\nimport View from 'ol/View.js';\nimport { Stroke, Style } from 'ol/style.js';\nimport { Tile as TileLayer, Vector as VectorLayer } from 'ol/layer.js';\nimport Stamen from 'ol/source/Stamen.js';\nimport VectorSource from 'ol/source/Vector.js';\nimport Feature from 'ol/Feature.js';\nimport LineString from 'ol/geom/LineString.js';\nimport { getVectorContext } from 'ol/render.js';\nimport { getWidth } from 'ol/extent.js';\nimport arc from 'arc';\nclass MapComponent extends Component {\n  componentDidMount() {\n    const tileLayer = new TileLayer({\n      source: new Stamen({\n        layer: 'toner'\n      })\n    });\n    const map = new Map({\n      layers: [tileLayer],\n      target: this.mapRef,\n      view: new View({\n        center: [-11000000, 4600000],\n        zoom: 2\n      })\n    });\n    const style = new Style({\n      stroke: new Stroke({\n        color: '#EAE911',\n        width: 2\n      })\n    });\n    const flightsSource = new VectorSource({\n      attributions: 'Flight data by ' + '<a href=\"https://openflights.org/data.html\">OpenFlights</a>,',\n      loader: function () {\n        const url = '../data/openflights/flights.json';\n        fetch(url).then(function (response) {\n          if (!response.ok) {\n            throw new Error('Network response was not ok');\n          }\n          return response.json();\n        }).then(function (json) {\n          const flightsData = json.flights;\n          for (let i = 0; i < flightsData.length; i++) {\n            const flight = flightsData[i];\n            const from = flight[0];\n            const to = flight[1];\n            const arcGenerator = new arc.GreatCircle({\n              x: from[1],\n              y: from[0]\n            }, {\n              x: to[1],\n              y: to[0]\n            });\n            const arcLine = arcGenerator.Arc(100, {\n              offset: 10\n            });\n            const features = [];\n            arcLine.geometries.forEach(function (geometry) {\n              const line = new LineString(geometry.coords);\n              line.transform('EPSG:4326', 'EPSG:3857');\n              features.push(new Feature({\n                geometry: line,\n                finished: false\n              }));\n            });\n            addLater(features, i * 50);\n          }\n          tileLayer.on('postrender', animateFlights);\n        }).catch(function (error) {\n          console.error('Error fetching JSON:', error);\n        });\n      }\n    });\n    const flightsLayer = new VectorLayer({\n      source: flightsSource,\n      style: function (feature) {\n        if (feature.get('finished')) {\n          return style;\n        }\n        return null;\n      }\n    });\n    map.addLayer(flightsLayer);\n    const pointsPerMs = 0.02;\n    function animateFlights(event) {\n      const vectorContext = getVectorContext(event);\n      const frameState = event.frameState;\n      vectorContext.setStyle(style);\n      const features = flightsSource.getFeatures();\n      for (let i = 0; i < features.length; i++) {\n        const feature = features[i];\n        if (!feature.get('finished')) {\n          const coords = feature.getGeometry().getCoordinates();\n          const elapsedTime = frameState.time - feature.get('start');\n          if (elapsedTime >= 0) {\n            const elapsedPoints = elapsedTime * pointsPerMs;\n            if (elapsedPoints >= coords.length) {\n              feature.set('finished', true);\n            }\n            const maxIndex = Math.min(elapsedPoints, coords.length);\n            const currentLine = new LineString(coords.slice(0, maxIndex));\n            const worldWidth = getWidth(map.getView().getProjection().getExtent());\n            const offset = Math.floor(map.getView().getCenter()[0] / worldWidth);\n            currentLine.translate(offset * worldWidth, 0);\n            vectorContext.drawGeometry(currentLine);\n            currentLine.translate(worldWidth, 0);\n            vectorContext.drawGeometry(currentLine);\n          }\n        }\n      }\n      map.render();\n    }\n    function addLater(features, timeout) {\n      window.setTimeout(function () {\n        let start = Date.now();\n        features.forEach(function (feature) {\n          feature.set('start', start);\n          flightsSource.addFeature(feature);\n          const duration = (feature.getGeometry().getCoordinates().length - 1) / pointsPerMs;\n          start += duration;\n        });\n      }, timeout);\n    }\n  }\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      ref: ref => this.mapRef = ref,\n      className: \"map\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 12\n      }\n    });\n  }\n}\nexport default MapComponent;","map":{"version":3,"names":["React","Component","Map","View","Stroke","Style","Tile","TileLayer","Vector","VectorLayer","Stamen","VectorSource","Feature","LineString","getVectorContext","getWidth","arc","MapComponent","componentDidMount","tileLayer","source","layer","map","layers","target","mapRef","view","center","zoom","style","stroke","color","width","flightsSource","attributions","loader","url","fetch","then","response","ok","Error","json","flightsData","flights","i","length","flight","from","to","arcGenerator","GreatCircle","x","y","arcLine","Arc","offset","features","geometries","forEach","geometry","line","coords","transform","push","finished","addLater","on","animateFlights","catch","error","console","flightsLayer","feature","get","addLayer","pointsPerMs","event","vectorContext","frameState","setStyle","getFeatures","getGeometry","getCoordinates","elapsedTime","time","elapsedPoints","set","maxIndex","Math","min","currentLine","slice","worldWidth","getView","getProjection","getExtent","floor","getCenter","translate","drawGeometry","render","timeout","window","setTimeout","start","Date","now","addFeature","duration","createElement","ref","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/mariovicky/Skripsi_OpenLayers/src/containers/Map/Map.js"],"sourcesContent":["import React, { Component } from 'react';\nimport 'ol/ol.css';\nimport './Map.css';\nimport Map from 'ol/Map.js';\nimport View from 'ol/View.js';\nimport { Stroke, Style } from 'ol/style.js';\nimport { Tile as TileLayer, Vector as VectorLayer } from 'ol/layer.js';\nimport Stamen from 'ol/source/Stamen.js';\nimport VectorSource from 'ol/source/Vector.js';\nimport Feature from 'ol/Feature.js';\nimport LineString from 'ol/geom/LineString.js';\nimport { getVectorContext } from 'ol/render.js';\nimport { getWidth } from 'ol/extent.js';\nimport arc from 'arc';\n\nclass MapComponent extends Component {\n  componentDidMount() {\n    const tileLayer = new TileLayer({\n      source: new Stamen({\n        layer: 'toner',\n      }),\n    });\n\n    const map = new Map({\n      layers: [tileLayer],\n      target: this.mapRef,\n      view: new View({\n        center: [-11000000, 4600000],\n        zoom: 2,\n      }),\n    });\n\n    const style = new Style({\n      stroke: new Stroke({\n        color: '#EAE911',\n        width: 2,\n      }),\n    });\n\n    const flightsSource = new VectorSource({\n      attributions:\n        'Flight data by ' +\n        '<a href=\"https://openflights.org/data.html\">OpenFlights</a>,',\n      loader: function () {\n        const url = '../data/openflights/flights.json';\n        fetch(url)\n          .then(function (response) {\n            if (!response.ok) {\n              throw new Error('Network response was not ok');\n            }\n            return response.json();\n          })\n          .then(function (json) {\n            const flightsData = json.flights;\n            for (let i = 0; i < flightsData.length; i++) {\n              const flight = flightsData[i];\n              const from = flight[0];\n              const to = flight[1];\n\n              const arcGenerator = new arc.GreatCircle(\n                { x: from[1], y: from[0] },\n                { x: to[1], y: to[0] }\n              );\n\n              const arcLine = arcGenerator.Arc(100, { offset: 10 });\n              const features = [];\n              arcLine.geometries.forEach(function (geometry) {\n                const line = new LineString(geometry.coords);\n                line.transform('EPSG:4326', 'EPSG:3857');\n\n                features.push(\n                  new Feature({\n                    geometry: line,\n                    finished: false,\n                  })\n                );\n              });\n\n              addLater(features, i * 50);\n            }\n\n            tileLayer.on('postrender', animateFlights);\n          })\n          .catch(function (error) {\n            console.error('Error fetching JSON:', error);\n          });\n      },\n    });\n\n    const flightsLayer = new VectorLayer({\n      source: flightsSource,\n      style: function (feature) {\n        if (feature.get('finished')) {\n          return style;\n        }\n        return null;\n      },\n    });\n\n    map.addLayer(flightsLayer);\n\n    const pointsPerMs = 0.02;\n    function animateFlights(event) {\n      const vectorContext = getVectorContext(event);\n      const frameState = event.frameState;\n      vectorContext.setStyle(style);\n\n      const features = flightsSource.getFeatures();\n      for (let i = 0; i < features.length; i++) {\n        const feature = features[i];\n        if (!feature.get('finished')) {\n          const coords = feature.getGeometry().getCoordinates();\n          const elapsedTime = frameState.time - feature.get('start');\n          if (elapsedTime >= 0) {\n            const elapsedPoints = elapsedTime * pointsPerMs;\n\n            if (elapsedPoints >= coords.length) {\n              feature.set('finished', true);\n            }\n\n            const maxIndex = Math.min(elapsedPoints, coords.length);\n            const currentLine = new LineString(coords.slice(0, maxIndex));\n\n            const worldWidth = getWidth(map.getView().getProjection().getExtent());\n            const offset = Math.floor(map.getView().getCenter()[0] / worldWidth);\n\n            currentLine.translate(offset * worldWidth, 0);\n            vectorContext.drawGeometry(currentLine);\n            currentLine.translate(worldWidth, 0);\n            vectorContext.drawGeometry(currentLine);\n          }\n        }\n      }\n\n      map.render();\n    }\n\n    function addLater(features, timeout) {\n      window.setTimeout(function () {\n        let start = Date.now();\n        features.forEach(function (feature) {\n          feature.set('start', start);\n          flightsSource.addFeature(feature);\n          const duration =\n            (feature.getGeometry().getCoordinates().length - 1) / pointsPerMs;\n          start += duration;\n        });\n      }, timeout);\n    }\n  }\n\n  render() {\n    return <div ref={(ref) => (this.mapRef = ref)} className=\"map\" />;\n  }\n}\n\nexport default MapComponent;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
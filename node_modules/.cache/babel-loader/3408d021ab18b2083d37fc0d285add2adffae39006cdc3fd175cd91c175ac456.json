{"ast":null,"code":"var _jsxFileName = \"/Users/mariovicky/Skripsi_OpenLayers/src/containers/Map/Map.js\";\nimport React, { Component } from 'react';\nimport 'ol/ol.css';\nimport './Map.css';\nimport { Map, View } from 'ol';\nimport { Tile as TileLayer, Vector as VectorLayer } from 'ol/layer';\nimport { OSM, Vector as VectorSource } from 'ol/source';\nimport { Fill, Stroke, Style } from 'ol/style';\nimport { getVectorContext } from 'ol/render';\nimport { getWidth } from 'ol/extent';\nimport { LineString } from 'ol/geom';\nclass MapComponent extends Component {\n  constructor(props) {\n    super(props);\n    this.loadFlights = () => {\n      const url = 'data/openflights/flights.json';\n      fetch(url).then(response => response.json()).then(json => {\n        const flightsData = json.flights;\n        for (let i = 0; i < flightsData.length; i++) {\n          const flight = flightsData[i];\n          const from = flight[0];\n          const to = flight[1];\n          const arcGenerator = new arc.GreatCircle({\n            x: from[1],\n            y: from[0]\n          }, {\n            x: to[1],\n            y: to[0]\n          });\n          const arcLine = arcGenerator.Arc(100, {\n            offset: 10\n          });\n          const features = [];\n          arcLine.geometries.forEach(geometry => {\n            const line = new LineString(geometry.coords);\n            line.transform('EPSG:4326', 'EPSG:3857');\n            features.push(new Feature({\n              geometry: line,\n              finished: false\n            }));\n          });\n          this.addFlights(features, i * 50);\n        }\n        this.flightsLayer.on('postrender', this.animateFlights);\n      });\n    };\n    this.addFlights = (features, timeout) => {\n      window.setTimeout(() => {\n        let start = Date.now();\n        features.forEach(feature => {\n          feature.set('start', start);\n          this.flightsSource.addFeature(feature);\n          const duration = (feature.getGeometry().getCoordinates().length - 1) / 0.02;\n          start += duration;\n        });\n      }, timeout);\n    };\n    this.animateFlights = event => {\n      const vectorContext = getVectorContext(event);\n      const frameState = event.frameState;\n      vectorContext.setStyle(new Style({\n        stroke: new Stroke({\n          color: '#EAE911',\n          width: 2\n        })\n      }));\n      const features = this.flightsSource.getFeatures();\n      for (let i = 0; i < features.length; i++) {\n        const feature = features[i];\n        const coords = feature.getGeometry().getCoordinates();\n        const elapsedTime = frameState.time - feature.get('start');\n        const elapsedPoints = elapsedTime / 1000 * 0.02;\n        if (elapsedPoints >= coords.length) {\n          feature.set('finished', true);\n        }\n        if (feature.get('finished')) {\n          continue;\n        }\n        const maxIndex = Math.min(elapsedPoints, coords.length);\n        const currentLine = new LineString(coords.slice(0, maxIndex));\n\n        // Draw the line\n        vectorContext.drawGeometry(currentLine);\n\n        // Animate the flight\n        if (maxIndex < coords.length) {\n          this.map.render();\n        }\n      }\n    };\n    this.state = {\n      center: [0, 0],\n      zoom: 1\n    };\n    this.map = null;\n    this.mapRef = /*#__PURE__*/React.createRef();\n    this.flightsSource = new VectorSource();\n    this.flightsLayer = new VectorLayer({\n      source: this.flightsSource,\n      style: new Style({\n        stroke: new Stroke({\n          color: '#EAE911',\n          width: 2\n        })\n      })\n    });\n  }\n  componentDidMount() {\n    this.map = new Map({\n      target: this.mapRef.current,\n      layers: [new TileLayer({\n        source: new OSM()\n      }), this.flightsLayer],\n      view: new View({\n        center: this.state.center,\n        zoom: this.state.zoom\n      })\n    });\n    this.map.on('moveend', () => {\n      const center = this.map.getView().getCenter();\n      const zoom = this.map.getView().getZoom();\n      this.setState({\n        center,\n        zoom\n      });\n    });\n    this.loadFlights();\n  }\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      ref: this.mapRef,\n      className: \"map\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }\n    }));\n  }\n}\nexport default MapComponent;","map":{"version":3,"names":["React","Component","Map","View","Tile","TileLayer","Vector","VectorLayer","OSM","VectorSource","Fill","Stroke","Style","getVectorContext","getWidth","LineString","MapComponent","constructor","props","loadFlights","url","fetch","then","response","json","flightsData","flights","i","length","flight","from","to","arcGenerator","arc","GreatCircle","x","y","arcLine","Arc","offset","features","geometries","forEach","geometry","line","coords","transform","push","Feature","finished","addFlights","flightsLayer","on","animateFlights","timeout","window","setTimeout","start","Date","now","feature","set","flightsSource","addFeature","duration","getGeometry","getCoordinates","event","vectorContext","frameState","setStyle","stroke","color","width","getFeatures","elapsedTime","time","get","elapsedPoints","maxIndex","Math","min","currentLine","slice","drawGeometry","map","render","state","center","zoom","mapRef","createRef","source","style","componentDidMount","target","current","layers","view","getView","getCenter","getZoom","setState","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref"],"sources":["/Users/mariovicky/Skripsi_OpenLayers/src/containers/Map/Map.js"],"sourcesContent":["import React, { Component } from 'react';\nimport 'ol/ol.css';\nimport './Map.css';\nimport { Map, View } from 'ol';\nimport { Tile as TileLayer, Vector as VectorLayer } from 'ol/layer';\nimport { OSM, Vector as VectorSource } from 'ol/source';\nimport { Fill, Stroke, Style } from 'ol/style';\nimport { getVectorContext } from 'ol/render';\nimport { getWidth } from 'ol/extent';\nimport { LineString } from 'ol/geom';\n\nclass MapComponent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      center: [0, 0],\n      zoom: 1,\n    };\n\n    this.map = null;\n    this.mapRef = React.createRef();\n    this.flightsSource = new VectorSource();\n    this.flightsLayer = new VectorLayer({\n      source: this.flightsSource,\n      style: new Style({\n        stroke: new Stroke({\n          color: '#EAE911',\n          width: 2,\n        }),\n      }),\n    });\n  }\n\n  componentDidMount() {\n    this.map = new Map({\n      target: this.mapRef.current,\n      layers: [\n        new TileLayer({\n          source: new OSM(),\n        }),\n        this.flightsLayer,\n      ],\n      view: new View({\n        center: this.state.center,\n        zoom: this.state.zoom,\n      }),\n    });\n\n    this.map.on('moveend', () => {\n      const center = this.map.getView().getCenter();\n      const zoom = this.map.getView().getZoom();\n      this.setState({ center, zoom });\n    });\n\n    this.loadFlights();\n  }\n\n  loadFlights = () => {\n    const url = 'data/openflights/flights.json';\n    fetch(url)\n      .then((response) => response.json())\n      .then((json) => {\n        const flightsData = json.flights;\n        for (let i = 0; i < flightsData.length; i++) {\n          const flight = flightsData[i];\n          const from = flight[0];\n          const to = flight[1];\n\n          const arcGenerator = new arc.GreatCircle(\n            { x: from[1], y: from[0] },\n            { x: to[1], y: to[0] }\n          );\n\n          const arcLine = arcGenerator.Arc(100, { offset: 10 });\n          const features = [];\n          arcLine.geometries.forEach((geometry) => {\n            const line = new LineString(geometry.coords);\n            line.transform('EPSG:4326', 'EPSG:3857');\n\n            features.push(\n              new Feature({\n                geometry: line,\n                finished: false,\n              })\n            );\n          });\n\n          this.addFlights(features, i * 50);\n        }\n\n        this.flightsLayer.on('postrender', this.animateFlights);\n      });\n  };\n\n  addFlights = (features, timeout) => {\n    window.setTimeout(() => {\n      let start = Date.now();\n      features.forEach((feature) => {\n        feature.set('start', start);\n        this.flightsSource.addFeature(feature);\n        const duration = (feature.getGeometry().getCoordinates().length - 1) / 0.02;\n        start += duration;\n      });\n    }, timeout);\n  };\n\n  animateFlights = (event) => {\n    const vectorContext = getVectorContext(event);\n    const frameState = event.frameState;\n    vectorContext.setStyle(new Style({\n      stroke: new Stroke({\n        color: '#EAE911',\n        width: 2,\n      }),\n    }));\n\n    const features = this.flightsSource.getFeatures();\n    for (let i = 0; i < features.length; i++) {\n      const feature = features[i];\n      const coords = feature.getGeometry().getCoordinates();\n      const elapsedTime = frameState.time - feature.get('start');\n      const elapsedPoints = (elapsedTime / 1000) * 0.02;\n\n      if (elapsedPoints >= coords.length) {\n        feature.set('finished', true);\n      }\n\n      if (feature.get('finished')) {\n        continue;\n      }\n\n      const maxIndex = Math.min(elapsedPoints, coords.length);\n      const currentLine = new LineString(coords.slice(0, maxIndex));\n\n      // Draw the line\n      vectorContext.drawGeometry(currentLine);\n\n      // Animate the flight\n      if (maxIndex < coords.length) {\n        this.map.render();\n      }\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"map-container\">\n        <div ref={this.mapRef} className=\"map\" />\n      </div>\n    );\n  }\n}\n\nexport default MapComponent;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}